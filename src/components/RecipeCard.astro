---
import { Image } from 'astro:assets';
import type { CollectionEntry } from 'astro:content';
import { Icon } from "astro-icon/components";

type Recipe = CollectionEntry<'recipes'>;

interface Props {
  recipe: Recipe;
  isActive: boolean | null;
}

const { recipe, isActive } = Astro.props;
---

<a
    class={isActive ? "card--active" : isActive === false ? "card--inactive" : ""}
    href=`/preview/${recipe.slug}`
>
    <div class="header">
        <Image class="image-blur" src={recipe.data.image} alt={recipe.data.title}/>
        <Image src={recipe.data.image} alt={recipe.data.title}/>
        <div class="total-time">
            <Icon name="solar:clock-circle-outline" size={18} />
            {recipe.data.totalTime}
        </div>
    </div>
    <div class="content">
        <h3>{recipe.data.title}</h3>
        <p>{recipe.data.subtitle}</p>
    </div>
</a>

<style lang="scss">
    a {
        all: unset;
        cursor: pointer;
        border-radius: 1rem;
        position: relative;

        &:hover,
        &:focus-visible {
            img {
                transform: scale(1.015);
            }
        }

        &.card--inactive {
            // opacity: .5;
        }
        &.card--active {
            opacity: 1;
            background: white;

            img {
                // transform: scale(0.95);
                transform-origin: center bottom;
            }
        }
    }

    .header {
        display: grid;
        grid-template-areas: "overlay";

        img {
            grid-area: overlay;
            width: 100%;
            height: auto;
            aspect-ratio: 16 / 9;
            object-fit: cover;
            border-radius: 1rem;
            transition: transform .2s ease;

            &.image-blur {
                z-index: -1;
                filter: blur(10px);
                scale: .95;
                translate: 0 15px;
                opacity: .5;
                pointer-events: none;
            }
        }

        .total-time {
            grid-area: overlay;
            justify-self: flex-end;
            align-self: flex-end;
            margin: 1rem;
            background: rgba(var(--page-background), .8);
            border-radius: .5rem;
            padding: 0 .5em;
            display: flex;
            align-items: center;
            gap: .5ch;
            backdrop-filter: blur(10px);
        }
    }

    .content {
        padding: 1rem;

        h3 {
            margin: 0;
        }

        p {
            margin: 0;
            color: #808080;
        }
    }
</style>